<apex:page showHeader="false" sidebar="false" language="{!selectedLanguageCode}" controller="CompApp_CtrlMakeAClaim" standardStylesheets="false" applyHtmlTag="false" applyBodyTag="false">
        
        <div id="make-a-claim-controller-wrapper">

            <h1 class="row">{!$label.CompApp_delay_claim}</h1>
            <div class="row p1">{!$label.CompApp_ClaimEligibility_TopParagraph}</div>

            <div class="row p1">{!$label.CompApp_required_fields}</div>

            <h2 class="row">{!$label.CompApp_Traveller_details}</h2>

            <div class="row {{formManager.firstNameValdity | validityClass}}">
                <label for="first-name" class="cell-label">{!$label.CompApp_First_name}</label>
                <div class="input-wrapper validity-sign cell-input">
                    <input 
                            placeholder="{!$label.CompApp_Traveller_First_Name}" 
                            id="first-name"
                            ng-pattern="USER_NAME_REGEX"
                            ng-change="formManager.firstNameValdity = !! $angularState.personalInfo.firstName"
                            ng-model="$angularState.personalInfo.firstName"
                    />  
                    <div class="error-message">{!$label.CompApp_enterFirstName}</div>
                </div>
            </div>

            <div class="row {{formManager.lastNameValdity | validityClass}}">
                <label for="surname" class="cell-label">{!$label.CompApp_Surname}</label>
                <div class="input-wrapper validity-sign cell-input">
                    <input 
                        maxlength="30"
                        placeholder="{!$label.CompApp_Traveller_Surname}" 
                        id="surname"
                        ng-pattern="USER_NAME_REGEX"
                        ng-change="formManager.lastNameValdity = !! $angularState.personalInfo.lastName" 
                        ng-model="$angularState.personalInfo.lastName"
                    />
                    <div class="error-message">{!$label.CompApp_enterLastName}</div>
                </div>
            </div>

            <div class="row {{formManager.primaryEmailValdity | validityClass}}">
                <label for="email" class="cell-label">{!$label.CompApp_email}</label>
                <div class="input-wrapper validity-sign cell-input">
                    <input type="email"
                           placeholder="{!$label.CompApp_Traveller_Email}"
                           id="email"
                           ng-change="formManager.primaryEmailValdity = isPrimaryEmailValid()"
                           ng-model="formManager.primaryEmail"
                    />
                    <div class="error-message">{!$label.CompApp_enterEmail}</div>
                </div>
            </div>

            <div class="row {{formManager.secondaryEmailValdity | validityClass}}">
                <label for="email" class="cell-label">{!$label.CompApp_Confirm_email}</label>
                <div class="input-wrapper validity-sign cell-input">
                    <input type="email"
                           placeholder="{!$label.CompApp_Traveller_Email}"
                           id="email"
                           ng-paste="preventPaste($event)"
                           ng-change="formManager.secondaryEmailValdity = isSecondaryEmailValid()"
                           ng-model="formManager.secondaryEmail"
                    />
                    <div class="error-message">{!$label.CompApp_confirmEmail}</div>
                </div>
            </div>

            <h2 class="row">{!$label.CompApp_booking_details}</h2>

            <div class="row tooltip {{formManager.TCNValdity | validityClass}}">
                <label for="tcn" class="cell-label">{!$label.CompApp_Ticket_number}</label> 
                <div class="input-wrapper validity-sign cell-input">
                    <input type="number"
                        onkeyup="console.log.bind(console);angular.element(this).scope().applyTCNChange($(this).val());" 
                        placeholder="{!$label.CompApp_nine_digit_ticket}" 
                        id="tcn"
                    />
                    <a class="tooltip-sign" id="tcn-tooltip"></a>
                    <div class="error-message">{!$label.CompApp_enterTCN}</div>
                </div>
           </div>

            <div class="row tooltip {{formManager.PNRValdity | validityClass}}">
                <label for="pnr" class="cell-label">{!$label.CompApp_Booking_reference}</label> 
                <div class="input-wrapper validity-sign cell-input">
                    <input 
                        placeholder="{!$label.CompApp_six_letter_booking}" 
                        id="pnr"  
                        ng-change="$angularState.travel.PNR = $angularState.travel.PNR.toUpperCase(); formManager.PNRValdity = isPNRValid()" 
                        ng-model="$angularState.travel.PNR"
                    />
                    <a class="tooltip-sign" id="pnr-tooltip"></a>
                    <div class="error-message">{!$label.CompApp_enterPNR}</div>
                </div>
            </div>

            <div class="row {{formManager.dateValidity | validityClass}}">
                <label for="dateInput" class="cell-label">{!$label.CompApp_Date_field_Label}</label> 
                <div class="input-wrapper validity-sign cell-input">
                    <datepicker
                            date-format="dd/MM/yyyy" date-min-limit="01/01/2000" date-max-limit="{{ $root.DateObj | date:'MM/dd/yyyy' }}"
                            button-prev="<span class='datepicker-month-arrow'>&lt;</span>"
                            button-next="<span class='datepicker-month-arrow'>&gt;</span>"
                    >
                        <input
                            type="text" 
                            placeholder="{!$Label.CompApp_date_input_placeholder}" 
                            id="dateInput"  
                            name="myVariable"
                            ng-model="$angularState.travel.dateOfTravel"
                            max="todayDate"
                            readonly="readonly"
                        />
                    </datepicker>
                    <div class="error-message">{!$label.CompApp_enterDate}</div>
                </div>
            </div>

            <div class="row {{ formManager.captchaValdity | validityClass }}">
                <label for="recaptcha" class="cell-label" >{!$label.CompApp_robot_question}</label>
                <div class="cell-input">
                    <no-captcha
                        g-recaptcha-response="captchaResponse"
                        theme='light'
                        control="noCaptchaControl"
                        site-key="{!GOOGLE_CAPTCHA_SITE_KEY}"
                    >
                    </no-captcha>
                    <div class="error-message">{!$label.CompApp_Validate_not_robot}</div>
                </div>
            </div>

            <div class="row commands-section">
                <a class="btn primary" ng-click="checkUserEligibility();">{!$label.CompApp_Eligibility_Check}</a>
                <p  class="error-message-main" ng-hide="formManager.noErrors">{!$label.CompApp_incorrectData}</p>
            </div>

            <script>
                var GLOBAL_REMOTE_USER_IP = '{!USER_IP}';
            </script>
        </div> <!-- END OF make-claim controller -->    

        <!--OLD block-->
        <div id="pnr-tooltip-images-template" style="display:none;">
            <div class="images-wrapper">
                <img src="" />
                <img src="" />
                <img src="" />
                <img src="" />
            </div>
        </div>
        <!--TCN-->
        <div id="tcn-digital-tooltip-images-template" style="display:none;">
            <div class="images-wrapper" id="tcn-digital">
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.EIL_MOBILE_TICKET_NAME}</figcaption>
                </figure>
                <!--<figure>-->
                    <!--<img src="" class="tcn"/>-->
                    <!--<figcaption>{!$label.Passbook_TICKET_NAME}</figcaption>-->
                <!--</figure>-->
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.NS_MOBILE_TICKET_NAME}</figcaption>
                </figure>
            </div>
        </div>

        <div id="tcn-cardboard-tooltip-images-template" style="display:none;">
            <div class="images-wrapper" id="tcn-cardboard">
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.EIL_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.SNCF_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.SNCB_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.NS_TICKET_NAME}</figcaption>
                </figure>
            </div>
        </div>
        <div id="tcn-printed-tooltip-images-template" style="display:none;">
            <div class="images-wrapper text-line__extended" id="tcn-printed">
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.Classic_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.New_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.Email_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.SNCB_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.NS_TICKET_NAME}</figcaption>
                </figure>
            </div>
        </div>
        <!--PNR-->
        <div id="pnr-digital-tooltip-images-template" style="display:none;">
            <div class="images-wrapper" id="pnr-digital">
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.EIL_MOBILE_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.Passbook_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.NS_MOBILE_TICKET_NAME}</figcaption>
                </figure>
            </div>
        </div>

        <div id="pnr-cardboard-tooltip-images-template" style="display:none;">
            <div class="images-wrapper" id="pnr-cardboard">
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.EIL_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.SNCF_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.SNCB_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.NS_TICKET_NAME}</figcaption>
                </figure>
            </div>
        </div>
        <div id="pnr-printed-tooltip-images-template" style="display:none;">
            <div class="images-wrapper" id="pnr-printed">
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.Classic_TICKET_NAME}</figcaption>
                </figure>
                <figure>
                    <img src="" class="tcn"/>
                    <figcaption>{!$label.New_TICKET_NAME}</figcaption>
                </figure>
            </div>
        </div>
        <script>function imgLoaded(img) { console.log('img loaded', img.src); }</script>
        <script>function imgError(img)  { console.log('img error',  img.src); }</script>
        <script>
            setTimeout(function () {

                var isDesktop = window.isDesktop = $(window).width() > 960,
                    pnrDigital = (isDesktop ? [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'digital/TCN-desktop-0.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'digital/TCN-desktop-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'digital/TCN-desktop-2.jpg') }"
                    ] : [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'digital/TCN-tablet-0.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'digital/TCN-tablet-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'digital/TCN-tablet-2.jpg') }"
                    ]),
                    pnrCardboard = (isDesktop ? [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'cardboard/TCN-desktop-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'cardboard/TCN-desktop-2.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'cardboard/TCN-desktop-3.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'cardboard/TCN-desktop-0.jpg') }"
                    ] : [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'cardboard/TCN-tablet-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'cardboard/TCN-tablet-2.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'cardboard/TCN-tablet-3.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'cardboard/TCN-tablet-0.jpg') }"
                    ]),
                    pnrPrinted = (isDesktop ? [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'printed/TCN-desktop-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'printed/TCN-desktop-0.jpg') }"
                    ] : [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'printed/TCN-tablet-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_PNR, 'printed/TCN-tablet-0.jpg') }"
                    ]),
                    tcnDigital = (isDesktop ? [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'digital/TCN-desktop-0.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'digital/TCN-desktop-2.jpg') }"
                    ] : [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'digital/TCN-tablet-0.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'digital/TCN-tablet-2.jpg') }"
                    ]),
                    tcnCardboard = (isDesktop ? [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'cardboard/TCN-desktop-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'cardboard/TCN-desktop-2.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'cardboard/TCN-desktop-3.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'cardboard/TCN-desktop-0.jpg') }"
                    ] : [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'cardboard/TCN-tablet-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'cardboard/TCN-tablet-2.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'cardboard/TCN-tablet-3.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'cardboard/TCN-tablet-0.jpg') }"
                    ]),
                    tcnPrinted = (isDesktop ? [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-desktop-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-desktop-0.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-desktop-2.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-desktop-3.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-desktop-4.jpg') }"
                    ] : [
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-tablet-1.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-tablet-0.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-tablet-2.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-tablet-3.jpg') }",
                        "{! URLFOR($Resource.CompApp_Eurostar_Ticket_Examples_TCN, 'printed/TCN-tablet-4.jpg') }"
                    ]),

                    $pnrDigitalImagesWrapper = $('#pnr-digital-tooltip-images-template > div'),
                    $pnrCardboardImagesWrapper = $('#pnr-cardboard-tooltip-images-template > div'),
                    $pnrPrintedImagesWrapper = $('#pnr-printed-tooltip-images-template > div'),
                    $tcnDigitalImagesWrapper = $('#tcn-digital-tooltip-images-template > div'),
                    $tcnCardboardImagesWrapper = $('#tcn-cardboard-tooltip-images-template > div'),
                    $tcnPrintedImagesWrapper = $('#tcn-printed-tooltip-images-template > div');


                $pnrDigitalImagesWrapper.
                    find('img').
                    each(function (i, img) { img.src = pnrDigital[i] || ''; });

                $pnrCardboardImagesWrapper.
                    find('img').
                    each(function (i, img) { img.src = pnrCardboard[i] || ''; });

                $pnrPrintedImagesWrapper.
                    find('img').
                    each(function (i, img) { img.src = pnrPrinted[i] || ''; });

                $tcnDigitalImagesWrapper.
                    find('img').
                    each(function (i, img) { img.src = tcnDigital[i] || ''; });

                $tcnCardboardImagesWrapper.
                    find('img').
                    each(function (i, img) { img.src = tcnCardboard[i] || ''; });

                $tcnPrintedImagesWrapper.
                    find('img').
                    each(function (i, img) { img.src = tcnPrinted[i] || ''; });

                $('#tcn-tooltip').click(openTooltip.bind(null, {
                    title: "{!$label.CompApp_find_ticket_number}",
                    description: "{!$label.CompApp_Press_For_Preview}",
                    digital: "{!$Label.CompApp_Digital_Section}",
                    cardboard: "{!$Label.CompApp_Cardboard_Section}",
                    printed: "{!$Label.CompApp_Printed_Section}",
                    text: [
                        $tcnDigitalImagesWrapper,
                        $tcnCardboardImagesWrapper,
                        $tcnPrintedImagesWrapper,
                        "{!$label.CompApp_locate_ticket_number} <a target='_blank' href='http://eurostarhelp.force.com/faq/?language=uk-en'>{!$label.CompApp_Help_Centre}</a>"
                    ],
                    mode: "tcn"
                }));
            
                $('#pnr-tooltip').click(openTooltip.bind(null, {
                    title: "{!$label.CompApp_find_booking_reference}",
                    description: "{!$label.CompApp_Press_For_Preview}",
                    digital: "{!$Label.CompApp_Digital_Section}",
                    cardboard: "{!$Label.CompApp_Cardboard_Section}",
                    printed: "{!$Label.CompApp_Printed_Section}",
                    text: [
                        $pnrDigitalImagesWrapper,
                        $pnrCardboardImagesWrapper,
                        $pnrPrintedImagesWrapper,
                        "{!$label.CompApp_locate_ticket_number} <a target='_blank' href='http://eurostarhelp.force.com/faq/?language=uk-en'>{!$label.CompApp_Help_Centre}</a>"
                    ],
                    mode: "pnr"
                }));

            // });
            }, 150);
        </script>
</apex:page>