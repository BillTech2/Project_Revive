<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Assign_3_English_CC_Cases_To_Me</fullName>
    <availability>online</availability>
    <displayType>massActionButton</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Assign 3 English CC Cases To Me</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <requireRowSelection>true</requireRowSelection>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/22.0/connection.js&quot;)} 

/*------------------------
CASE 1
------------------------*/


var updateRecord = new Array(); 
var myquery = &quot;SELECT Id FROM Case WHERE Owner.Id = &#39;00Gb00000012onb&#39; AND Status != &#39;Closed&#39; ORDER BY Date_Opened__c ASC&quot;;


result = sforce.connection.query(myquery); 
records = result.getArray(&quot;records&quot;); 

if(records[0]) 
{ 
var update_Case = records[0]; 
update_Case.OwnerId = &#39;{!User.Id}&#39;; 
updateRecord.push(update_Case);
} 

result = sforce.connection.update(updateRecord); 
parent.location.href = parent.location.href;

/*------------------------
CASE 2
------------------------*/

var updateRecord = new Array(); 
var myquery = &quot;SELECT Id FROM Case WHERE Owner.Id = &#39;00Gb00000012onb&#39; AND Status != &#39;Closed&#39; ORDER BY Date_Opened__c ASC&quot;;


result = sforce.connection.query(myquery); 
records = result.getArray(&quot;records&quot;); 

if(records[0]) 
{ 
var update_Case = records[0]; 
update_Case.OwnerId = &#39;{!User.Id}&#39;; 
updateRecord.push(update_Case); 
} 

result = sforce.connection.update(updateRecord); 
parent.location.href = parent.location.href;

/*------------------------
CASE 3
------------------------*/

var updateRecord = new Array(); 
var myquery = &quot;SELECT Id FROM Case WHERE Owner.Id = &#39;00Gb00000012onb&#39; AND Status != &#39;Closed&#39; ORDER BY Date_Opened__c ASC&quot;;


result = sforce.connection.query(myquery); 
records = result.getArray(&quot;records&quot;); 

if(records[0]) 
{ 
var update_Case = records[0]; 
update_Case.OwnerId = &#39;{!User.Id}&#39;; 
updateRecord.push(update_Case); 
alert(&#39;Cases Incoming!!&#39;); 
} 

result = sforce.connection.update(updateRecord); 
parent.location.href = parent.location.href;</url>
</WebLink>
